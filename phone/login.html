<!DOCTYPE html>
<html>

<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="./lib/mint-ui/style.css">
	<link rel="stylesheet" href="./common/css/jas-main.css">
</head>

<body>
	<div class="_outer-wrapper">
		<jas-header title="登录" :is-return="false"></jas-header>
		<div class="content-wrapper" v-setheight>

			<mt-field label="用户名" placeholder="请输入用户名" v-model="form.username"></mt-field>
			<mt-field label="密码" placeholder="请输入密码" type="password" v-model="form.password"></mt-field>
			<mt-button type="primary" @click.native="login" size="large">登录</mt-button>

		</div>
	</div>
</body>
<script src="./appcan/js/appcan.js"></script>
<script src="./lib/vue/vue.js"></script>
<script src="./lib/mint-ui/index.js"></script>
<script src="./common/js/jas-tools.js"></script>
<script src="./common/components/jas-components.js"></script>


<script>
	var vm = new Vue({
		el: '._outer-wrapper',
		data: function () {
			return {
				form: {
					username: 'admin',
					password: '111111',
				}
			}
		},
		created: function () {},
		mounted: function () {},
		methods: {
			login: function () {
				var that = this;
				var url = "/jasframework/login/login.do";
				that.$indicator.open({
					text: '正在登录...',
					spinnerType: 'fading-circle'
				});
				jasTools.ajax.post(url, {
					"logintype": "0",
					"loginNum": that.form.username,
					"pass": that.form.password,
					"i18n": "zh_CN",
					"appId": "402894a152681ba30152681e8b320003"
				}, function (data) {
					that.$indicator.close();

					localStorage.setItem("token", data.token);
					localStorage.setItem("user", JSON.stringify(data.user));
					localStorage.setItem("calculateType", 1); //1-显示桩和偏移量  2显示坐标

					appcan.window.open('index', 'index.html', 10, 16, 0, 0, 0);
					setTimeout(function () {
						// appcan.window.close(0);
					}, 800);
				});
			}
		},
	});
</script>

</html>