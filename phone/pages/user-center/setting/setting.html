<!DOCTYPE html>
<html>

<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="./../../../lib/mint-ui/style.css">
	<link rel="stylesheet" href="./../../../lib/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="./../../../common/css/jas-main.css">
</head>
<style>
	/*.mint-cell {
		margin-bottom: 10px;
	}*/
</style>

<body>
	<div class="_outer-wrapper " v-cloak>
		<jas-header title="个人设置"></jas-header>
		<div v-setheight style="overflow: auto;">
			<mt-cell v-for="item in setList" :title="item.name" :is-link="item.isLink" @click.native="goto(item)">
				<span v-show="item.value">{{item.value}}</span>
				<img :src="item.icon" v-show="item.icon" style="height:12vw;width:12vw">
			</mt-cell>
		</div>
	</div>
</body>
<script src="./../../../appcan/js/appcan.js"></script>
<script src="./../../../lib/vue/vue.js"></script>
<script src="./../../../lib/mint-ui/index.js"></script>
<script src="./../../../common/js/jas-tools.js"></script>
<script src="./../../../common/components/jas-components.js"></script>
<script>
	var vm = new Vue({
		el: '._outer-wrapper',
		data: function () {
			return {

				setList: [{
					name: '头像',
					isLink: true,
					icon: "../../../common/images/girl.png",
				}, {
					name: '账号',
					isLink: false,
					value: JSON.parse(localStorage.getItem("user")).userName
				}, {
					name: '单位',
					isLink: false,
					value: JSON.parse(localStorage.getItem("user")).unitName.split("->")[JSON.parse(localStorage.getItem("user"))
						.unitName.split("->").length - 1]
				}, {
					name: '密码修改',
					isLink: true,
					link: "updatePass.html"
				}]
			}
		},
		created: function () {

		},
		mounted: function () {
			var that = this;
			appcan.ready(function () {
				uexCamera.cbOpenInternal = function (opId, dataType, data) {
					var imgpic = data;
					appcan.logs(data);
					that.setList[0].icon = data;
					// upload(imgpic);
				};
				uexImage.onPickerClosed = function (info) {
					var objData = JSON.parse(info);
					if (!objData.isCancelled) {
						var imgPaths = objData.data;
						for (var i = 0; i < imgPaths.length; i++) {
							that.setList[0].icon  = imgPaths[i];
							// upload(imgPaths[i]);
						}
					}
				};
			})
		},
		methods: {
			goto: function (item) {
				if (item.link) {
					appcan.window.open("config", item.link, 10, 16, 0, 0, 0);
				} else {
					this.choosePhoto();
				}
			},
			choosePhoto: function () {
				var that = this;
				var x = 0;
				var y = 0;
				var width = 0;
				var height = 0;
				var JsonData = {
					"actionSheet_style": {
						"frameBgColor": "#00000000",
						"frameBroundColor": "#00000000",
						"frameBgImg": "",
						"btnSelectBgImg": "res://btn.png",
						"btnUnSelectBgImg": "res://btn.png",
						"cancelBtnSelectBgImg": "res://btn.png",
						"cancelBtnUnSelectBgImg": "res://btn.png",
						"textSize": "17",
						"textNColor": "#333",
						"textHColor": "#333",
						"cancelTextNColor": "#333",
						"cancelTextHColor": "#333",
						"actionSheetList": [{
							"name": "拍照"
						}, {
							"name": "从相册选择"
						}]
					}
				};
				uexActionSheet.open(x, y, width, height, JSON.stringify(JsonData));
				uexActionSheet.onClickItem = function (data) {
					if (data == 1) {
						that.openAlbum();
						//打开相册
					} else if (data == 0) {
						that.openCarme();
						//打开照相机
					}
				}
			},
			openAlbum: function () {
				var data = {
					min: 1,
					max: 1,
					quality: 0.5,
					detailedInfo: false
				};
				var json = JSON.stringify(data);
				uexImage.openPicker(json);
			},
			openCarme: function () {
				uexCamera.openInternal(0, 75);
			}
		},
	});
</script>

</html>